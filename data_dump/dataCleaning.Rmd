---
title: "TeamsCleaning"
author: "Aaron Simot"
date: "10/25/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{R libraries, include = FALSE}
library(tidyverse)
```


```{R data_load_bat, include = FALSE}

#reading in the teams batting standards data
teamsBat <- read_csv2(here::here("data_dump/teamsBattingStandards1900_2020"))
teamsPitch <- read_csv2(here::here("data_dump/teamsPitchingStandards1900_2020"))

```



```{R cleaning_bats}

#selecting columns that need to be converted to numeric
cols <- colnames(teamsBat)
cols <- cols[2:30]

#removing all the summary values for each year that was extracted
cleanTeamsBat <- teamsBat %>%
  #cleaning out some of the column headers and league averages saved as team data
  filter(!is.na(Tm), Tm != "League Average", Tm != "Tm")

#have to switch back char columns to numeric from initial scrape file
#needed to convert all to char due to map_df issues thinking column names were datapoints
cleanTeamsBat[cols] <- sapply(cleanTeamsBat[cols], as.numeric) #converting numeric cols back to numeric

#cleanTeamsBat

```



```{R clean_pitch}
#selecting columns that need to be converted to numeric
colsPitch <- colnames(teamsPitch)
colsPitch <- colsPitch[2:37]

#removing all the summary values for each year that was extracted
cleanTeamsPitch <- teamsPitch %>%
  #cleaning out some of the column headers and league averages saved as team data
  filter(!is.na(Tm), Tm != "League Average", Tm != "Tm")

#have to switch back char columns to numeric from initial scrape file
#needed to convert all to char due to map_df issues thinking column names were datapoints
cleanTeamsPitch[colsPitch] <- sapply(cleanTeamsPitch[colsPitch], as.numeric) #converting numeric cols back to numeric

#cleanTeamsPitch

```

Notable name changes:
  *Tampa Bay Devil Rays -> Tampa Bay Rays
  *Los Angeles Angels -> California Angels -> Anaheim Angels -> Los Angeles Angels of Anaheim -> Los Angeles Angels
  *Montreal Expos -> Washington Nationals -> Washington Senators
  *Houston Colt .45s -> Houston Astros
  *Milwaukee Braves -> Atlanta Braves
  *Kansas City Athletics -> Oakland Athletics
  *Seattle Pilots -> Milwaukee Brewers

```{r name_changes}

cleanTeamsBat <- cleanTeamsBat %>%
  #retaining our desired year subset for displays
  filter(year > 1960) %>%
  #convert historic names to most recent names of teams
  mutate(Tm = case_when(
    Tm == "Tampa Bay Devil Rays" ~ "Tampa Bay Rays",
    
    Tm == "California Angels" ~ "Los Angeles Angels",
    Tm == "Anaheim Angels" ~ "Los Angeles Angels",
    Tm == "Los Angeles Angels of Anaheim" ~ "Los Angeles Angels",
    Tm == "Los Angles Angels" ~ "Los Angeles Angels",
    
    Tm == "Montreal Expos" ~ "Washington Senators",
    Tm == "Washington Nationals" ~ "Washington Senators",
    Tm == "Houston Colt .45s" ~ "Houston Astros",
    Tm == "Milwaukee Braves" ~ "Atlanta Braves",
    Tm == "Kansas City Athletics" ~ "Oakland Athletics",
    Tm == "Seattle Pilots" ~ "Milwaukee Brewers",
    TRUE ~ Tm
  ))

cleanTeamsPitch <- cleanTeamsPitch %>%
  #retaining our desired year subset for displays
  filter(year > 1960) %>%
  #convert historic names to most recent names of teams
  mutate(Tm = case_when(
    Tm == "Tampa Bay Devil Rays" ~ "Tampa Bay Rays",
    
    Tm == "California Angels" ~ "Los Angeles Angels",
    Tm == "Anaheim Angels" ~ "Los Angeles Angels",
    Tm == "Los Angeles Angels of Anaheim" ~ "Los Angeles Angels",
    Tm == "Los Angles Angels" ~ "Los Angeles Angels",
    
    Tm == "Montreal Expos" ~ "Washington Senators",
    Tm == "Washington Nationals" ~ "Washington Senators",
    Tm == "Houston Colt .45s" ~ "Houston Astros",
    Tm == "Milwaukee Braves" ~ "Atlanta Braves",
    Tm == "Kansas City Athletics" ~ "Oakland Athletics",
    Tm == "Seattle Pilots" ~ "Milwaukee Brewers",
    TRUE ~ Tm
  ))

unique(cleanTeamsBat$Tm)

```




```{R exports}
#exporting the partially cleaned teams batting data
write_csv2(cleanTeamsBat, here::here("data_dump/cleanTeamsBat1900_2020"))

#exporting the partially cleaned teams pitching data
write_csv2(cleanTeamsPitch, here::here("data_dump/cleanTeamsPitch1900_2020"))
```







